-- Mateus Agostinho dos Anjos
-- NUSP: 9298191


-- Consulta a)
SELECT SUM(qtdequilos) FROM Restaurante, Entrega
WHERE (Restaurante.nomer = 'RU-USP') AND
(Restaurante.codr = Entrega.codr);

-- Consulta b)
SELECT cidadea, COUNT(cidadea) FROM Agricultor
GROUP BY cidadea
HAVING COUNT(cidadea) >= 2;

-- Consulta c)
SELECT codp, AVG(qtdequilos) FROM Entrega
WHERE codp IN
	(SELECT codp FROM Entrega
	EXCEPT
	SELECT codp FROM Entrega
	WHERE qtdequilos < 20)
GROUP BY codp;

-- Consulta d)
SELECT nomep, SUM (qtdequilos) AS quilosVendidos FROM Produto, Entrega
WHERE Produto.codp = Entrega.codp
GROUP BY (nomep) ORDER BY (SUM(qtdequilos)) DESC
LIMIT 1;